<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>系统登录 - 管理员/代理通用</title>
    <link rel="stylesheet" href="common.css">
</head>
<body>
    <div class="login-container">
        <h2>系统登录</h2>
        <div class="input-box">
            <label for="username">账号</label>
            <input type="text" id="username" placeholder="请输入管理员/代理账号" autocomplete="off">
        </div>
        <div class="input-box">
            <label for="password">密码</label>
            <input type="password" id="password" placeholder="请输入密码" autocomplete="off">
        </div>
        <button class="login-btn" onclick="handleLogin()">立即登录</button>
    </div>

    <script src="config.js"></script>
    <script src="common.js"></script>
    <script>
        // 登录核心函数
        async function handleLogin() {
            const username = document.getElementById("username").value.trim();
            const password = document.getElementById("password").value.trim();

            // 空值校验
            if (!username || !password) {
                alert("账号和密码不能为空！");
                return;
            }

            // 校验账号密码（从config.js的用户列表获取）
            const user = USER_LIST.find(item => item.username === username && item.password === password);
            if (!user) {
                alert("账号或密码错误！");
                return;
            }

            // 登录成功：保存用户信息到本地（替代后端session）
            localStorage.setItem("loginUser", JSON.stringify(user));
            alert(`${user.role === "admin" ? "超级管理员" : "代理"}登录成功！`);
            
            // 根据角色跳转专属页面（纯GitHub Pages路径）
            window.location.href = user.role === "admin" ? "admin.html" : "proxy.html";
        }

        // 回车触发登录
        document.addEventListener("keydown", (e) => {
            e.key === "Enter" && handleLogin();
        });
    </script>
</body>
</html>
